#!/bin/bash




monitoringDir="${HOME}/code/ronin/libs/monitoring/VplatGUI/"

#----------------------------------------------
# Main script
#----------------------------------------------
ARGS=$(getopt -o h -l "help" -n "$(basename ${0})" -- "$@")
scriptOptions=$(echo ${ARGS} | awk -F ' -- ' '{print $1}')

# If wrong arguments, print usage and exit
if [[ $? -ne 0 ]]; then
    printUsage
    exit 1;
fi

eval set -- "$ARGS"

while true; do
    case ${1} in
    -h|--help)
        printUsage
        exit 0
        ;;
    --)
        shift
        break
        ;;
    "")
        # This is necessary for processing missing optional arguments 
        shift
        ;;
    esac
done

if [[ $# -lt 1 ]]; then
    printUsage
    exit 1
fi

venues=${1}
if [[ ${venues} == 'prod' ]]; then
    venues=$(ls ${monitoringDir} | grep -v uat)
fi

outfile="output.$(date +%Y%m%d-%H%M%S).log"
for v in ${venues}; do
    echo v=${v}
    cd ${monitoringDir}/${v} && (./rungui > ${outfile} &) && cd - > /dev/null
done

